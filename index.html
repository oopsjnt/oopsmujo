<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4a90e2">
    <meta name="description" content="Aplicativo de mototáxi para o seu bairro">
    <title>MotoTáxi do Bairro</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <!-- Firebase App (a base) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <!-- Adicione os produtos Firebase que você quer usar -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-messaging-compat.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>MotoTáxi do Bairro</h1>
            <p>Transporte rápido e seguro para o seu dia a dia</p>
        </header>

        <!-- Seção de Login/Cadastro (Visível inicialmente) -->
        <section id="auth-section" class="auth-section">
            <div class="tabs">
                <button id="login-tab" class="tab active">Login</button>
                <button id="register-tab" class="tab">Cadastro</button>
            </div>
            
            <!-- Formulário de Login -->
            <div id="login-form" class="form-container">
                <h2>Entrar na sua conta</h2>
                <div class="form-group">
                    <label for="login-email">Email:</label>
                    <input type="email" id="login-email" placeholder="Seu email">
                </div>
                <div class="form-group">
                    <label for="login-password">Senha:</label>
                    <input type="password" id="login-password" placeholder="Sua senha">
                </div>
                <div class="form-group">
                    <button id="login-button" class="primary-button">Entrar</button>
                </div>
            </div>
            
            <!-- Formulário de Cadastro -->
            <div id="register-form" class="form-container hidden">
                <h2>Criar nova conta</h2>
                <div class="form-group">
                    <label for="register-name">Nome completo:</label>
                    <input type="text" id="register-name" placeholder="Seu nome completo">
                </div>
                <div class="form-group">
                    <label for="register-phone">Telefone:</label>
                    <input type="tel" id="register-phone" placeholder="Seu telefone com DDD">
                </div>
                <div class="form-group">
                    <label for="register-email">Email:</label>
                    <input type="email" id="register-email" placeholder="Seu email">
                </div>
                <div class="form-group">
                    <label for="register-password">Senha:</label>
                    <input type="password" id="register-password" placeholder="Crie uma senha">
                </div>
                <div class="form-group">
                    <label>Tipo de conta:</label>
                    <div class="radio-group">
                        <input type="radio" id="user-type" name="account-type" value="user" checked>
                        <label for="user-type">Passageiro</label>
                        
                        <input type="radio" id="driver-type" name="account-type" value="driver">
                        <label for="driver-type">Mototaxista</label>
                    </div>
                </div>
                <div class="form-group">
                    <button id="register-button" class="primary-button">Cadastrar</button>
                </div>
            </div>
        </section>

        <!-- Seção Principal do App (Escondida até login) -->
        <section id="app-section" class="app-section hidden">
            <!-- Conteúdo do App será carregado dinamicamente baseado no tipo de usuário -->
            <div class="user-info">
                <p>Olá, <span id="user-name">Usuário</span>!</p>
                <button id="logout-button" class="secondary-button">Sair</button>
            </div>
            
            <!-- Interface do Passageiro -->
            <div id="passenger-interface" class="interface-container hidden">
                <h2>Solicitar Corrida</h2>
                <div class="form-group">
                    <label for="pickup-location">Onde você está?</label>
                    <input type="text" id="pickup-location" placeholder="Ex: Rua das Flores, 123">
                </div>
                <div class="form-group">
                    <label for="destination">Para onde deseja ir?</label>
                    <input type="text" id="destination" placeholder="Ex: Shopping Center">
                </div>
                <div class="form-group">
                    <button id="request-ride-button" class="primary-button">Solicitar Mototáxi</button>
                </div>
                
                <div id="ride-status" class="status-container hidden">
                    <h3>Status da sua corrida</h3>
                    <p id="status-message">Procurando mototaxistas próximos...</p>
                </div>
            </div>
            
            <!-- Interface do Mototaxista -->
            <div id="driver-interface" class="interface-container hidden">
                <h2>Painel do Mototaxista</h2>
                <div class="status-toggle">
                    <label for="driver-status">Status:</label>
                    <select id="driver-status">
                        <option value="available">Disponível</option>
                        <option value="unavailable">Indisponível</option>
                    </select>
                </div>
                
                <div id="available-rides" class="rides-container">
                    <h3>Corridas Disponíveis</h3>
                    <div id="rides-list" class="rides-list">
                        <!-- As corridas serão adicionadas dinamicamente aqui -->
                        <p class="empty-message">Nenhuma corrida disponível no momento.</p>
                    </div>
                </div>
                
                <div id="current-ride" class="current-ride hidden">
                    <h3>Corrida Atual</h3>
                    <div class="ride-details">
                        <p><strong>Passageiro:</strong> <span id="passenger-name">-</span></p>
                        <p><strong>Local de partida:</strong> <span id="ride-pickup">-</span></p>
                        <p><strong>Destino:</strong> <span id="ride-destination">-</span></p>
                    </div>
                    <div class="ride-actions">
                        <button id="complete-ride-button" class="primary-button">Finalizar Corrida</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Banner de instalação do PWA -->
        <div id="pwa-install-banner" class="pwa-banner hidden">
            <p>Instale nosso app para uma experiência melhor!</p>
            <button id="pwa-install-button" class="primary-button">Instalar</button>
            <button id="pwa-close-button" class="secondary-button">Agora não</button>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Registrar o Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registrado com sucesso:', registration);
                    })
                    .catch(error => {
                        console.error('Erro ao registrar Service Worker:', error);
                    });
            });
        }
        
        // Variáveis para o banner de instalação do PWA
        let deferredPrompt;
        const pwaInstallBanner = document.getElementById('pwa-install-banner');
        const pwaInstallButton = document.getElementById('pwa-install-button');
        const pwaCloseButton = document.getElementById('pwa-close-button');
        
        // Evento disparado antes do prompt de instalação
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevenir o prompt automático
            e.preventDefault();
            // Armazenar o evento para uso posterior
            deferredPrompt = e;
            // Mostrar o banner de instalação
            pwaInstallBanner.classList.remove('hidden');
        });
        
        // Botão de instalação
        pwaInstallButton.addEventListener('click', () => {
            // Esconder o banner
            pwaInstallBanner.classList.add('hidden');
            // Mostrar o prompt de instalação
            deferredPrompt.prompt();
            // Esperar pela escolha do usuário
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('Usuário aceitou a instalação do PWA');
                } else {
                    console.log('Usuário recusou a instalação do PWA');
                }
                // Limpar a referência
                deferredPrompt = null;
            });
        });
        
        // Botão para fechar o banner
        pwaCloseButton.addEventListener('click', () => {
            pwaInstallBanner.classList.add('hidden');
        });
    </script>
</body>
</html>
