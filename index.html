<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0f3460">
    <title>Oops Transportes Caramujo</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
</head>
<body class="dark-theme">
    <!-- Banner de instala√ß√£o PWA -->
    <div id="pwa-banner" class="pwa-banner hidden">
        <p>Instale o app para uma melhor experi√™ncia!</p>
        <button id="install-pwa" class="primary-button">Instalar</button>
        <button id="close-pwa-banner" class="close-button">&times;</button>
    </div>

    <!-- Se√ß√£o de Autentica√ß√£o -->
    <section id="auth-section" class="auth-section">
        <div class="auth-container">
            <div class="logo">
                <img src="icons/icon-512x512.png" alt="Oops Transportes Caramujo">
                <h1>Oops Transportes Caramujo</h1>
            </div>
            <div class="tabs">
                <button id="login-tab" class="tab-button active">Login</button>
                <button id="register-tab" class="tab-button">Cadastro</button>
            </div>
            <div id="login-form" class="form-container">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" placeholder="Seu email">
                </div>
                <div class="form-group">
                    <label for="login-password">Senha</label>
                    <input type="password" id="login-password" placeholder="Sua senha">
                </div>
                <button id="login-button" class="primary-button">Entrar</button>
            </div>
            <div id="register-form" class="form-container hidden">
                <div class="form-group">
                    <label for="register-name">Nome</label>
                    <input type="text" id="register-name" placeholder="Seu nome completo">
                </div>
                <div class="form-group">
                    <label for="register-phone">Telefone</label>
                    <input type="tel" id="register-phone" placeholder="Seu telefone com DDD">
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" placeholder="Seu email">
                </div>
                <div class="form-group">
                    <label for="register-password">Senha</label>
                    <input type="password" id="register-password" placeholder="Sua senha">
                </div>
                <div class="form-group">
                    <label>Tipo de conta</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="account-type" value="user" checked>
                            Passageiro
                        </label>
                        <label>
                            <input type="radio" name="account-type" value="driver">
                            Mototaxista
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="terms-checkbox">
                        Aceito os <a href="#" id="show-terms">termos de uso</a>
                    </label>
                </div>
                <button id="register-button" class="primary-button" disabled>Cadastrar</button>
            </div>
        </div>
    </section>

    <!-- Modal de Termos de Uso -->
    <div id="terms-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Termos de Uso - Oops Transportes Caramujo</h2>
            <div class="terms-content">
                <p>Ao utilizar o aplicativo Oops Transportes Caramujo, voc√™ concorda com os seguintes termos:</p>
                
                <h3>1. Responsabilidade</h3>
                <p>A Oops Transportes Caramujo n√£o se responsabiliza pelos profissionais e/ou usu√°rios do sistema. Somos apenas uma plataforma que conecta clientes aos profissionais de transporte.</p>
                
                <h3>2. Isen√ß√£o de Responsabilidade</h3>
                <p>N√£o nos responsabilizamos por perdas, acidentes, documenta√ß√£o do motorista e ve√≠culos. A verifica√ß√£o da documenta√ß√£o e condi√ß√µes do ve√≠culo √© de responsabilidade do usu√°rio.</p>
                
                <h3>3. Fun√ß√£o da Plataforma</h3>
                <p>Somos apenas uma plataforma intermedi√°ria que facilita o contato entre passageiros e mototaxistas. N√£o prestamos servi√ßos de transporte diretamente.</p>
                
                <h3>4. Uso do Aplicativo</h3>
                <p>O usu√°rio concorda em utilizar o aplicativo de forma adequada, fornecendo informa√ß√µes verdadeiras e atualizadas.</p>
                
                <h3>5. Avalia√ß√µes</h3>
                <p>As avalia√ß√µes s√£o importantes para manter a qualidade do servi√ßo. O usu√°rio concorda em fornecer avalia√ß√µes honestas e construtivas.</p>
            </div>
            <button id="accept-terms" class="primary-button">Aceitar Termos</button>
        </div>
    </div>

    <!-- Se√ß√£o Principal do App -->
    <section id="app-section" class="app-section hidden">
        <header>
            <div class="user-info">
                <img id="user-profile-picture" src="icons/default-profile.png" alt="Foto de perfil">
                <span id="user-name">Usu√°rio</span>
            </div>
            <div class="header-buttons">
                <button id="profile-button" class="icon-button">üë§</button>
                <button id="logout-button" class="icon-button">üö™</button>
            </div>
        </header>
        
        <nav class="main-nav">
            <button id="nav-main" class="nav-button active">Principal</button>
            <button id="nav-history" class="nav-button">Hist√≥rico</button>
            <button id="nav-profile" class="nav-button">Perfil</button>
            <button id="nav-suggestions" class="nav-button">Sugest√µes</button>
            <button id="nav-prices" class="nav-button">Pre√ßos</button>
        </nav>
        
        <!-- Se√ß√£o Principal -->
        <div id="main-section" class="content-section">
            <!-- Interface do Passageiro -->
            <div id="passenger-interface" class="hidden">
                <h2>Solicitar Corrida</h2>
                <div class="form-group">
                    <label for="pickup-location">Local de Partida</label>
                    <div class="location-input-group">
                        <input type="text" id="pickup-location" placeholder="Onde voc√™ est√°?">
                        <button id="use-current-location" class="secondary-button">Usar minha localiza√ß√£o atual</button>
                    </div>
                    <p id="location-status" class="status-message hidden">Obtendo localiza√ß√£o...</p>
                </div>
                <div class="form-group">
                    <label for="destination">Destino</label>
                    <input type="text" id="destination" placeholder="Para onde voc√™ vai?">
                </div>
                <button id="request-ride-button" class="primary-button">Solicitar Motot√°xi</button>
                
                <!-- Status da Corrida -->
                <div id="ride-status" class="ride-status hidden">
                    <h3>Status da Corrida</h3>
                    <p id="status-message">Procurando mototaxistas pr√≥ximos...</p>
                    <div id="whatsapp-contact" class="whatsapp-contact hidden"></div>
                    <button id="cancel-ride-button" class="secondary-button">Cancelar Corrida</button>
                </div>
                
                <!-- Mototaxistas Pr√≥ximos -->
                <div id="nearby-drivers" class="nearby-drivers"></div>
            </div>
            
            <!-- Interface do Mototaxista -->
            <div id="driver-interface" class="hidden">
                <div class="driver-status-container">
                    <h2>Seu Status</h2>
                    <select id="driver-status" class="status-select">
                        <option value="unavailable">Indispon√≠vel</option>
                        <option value="available">Dispon√≠vel</option>
                    </select>
                </div>
                
                <div id="driver-rating" class="driver-rating">
                    <h3>Sua Avalia√ß√£o M√©dia</h3>
                    <div class="average-rating">
                        <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                        <span class="rating-value">5.0</span>
                        <span class="rating-count">(0 avalia√ß√µes)</span>
                    </div>
                </div>
                
                <div class="rides-container">
                    <h3>Corridas Dispon√≠veis</h3>
                    <div id="rides-list" class="rides-list">
                        <p class="empty-message">Nenhuma corrida dispon√≠vel no momento.</p>
                    </div>
                </div>
                
                <!-- Corrida Atual -->
                <div id="current-ride" class="current-ride hidden">
                    <h3>Corrida em Andamento</h3>
                    <div class="current-ride-details">
                        <p><strong>Passageiro:</strong> <span id="passenger-name">Nome do Passageiro</span></p>
                        <p><strong>Partida:</strong> <span id="ride-pickup">Local de Partida</span></p>
                        <p><strong>Destino:</strong> <span id="ride-destination">Destino</span></p>
                    </div>
                    <div id="whatsapp-contact-driver" class="whatsapp-contact hidden"></div>
                    <button id="complete-ride-button" class="primary-button">Finalizar Corrida</button>
                </div>
            </div>
        </div>
        
        <!-- Se√ß√£o de Hist√≥rico -->
        <div id="history-section" class="content-section hidden">
            <h2>Hist√≥rico de Corridas</h2>
            <div id="ride-history" class="history-container">
                <p class="loading-message">Carregando hist√≥rico...</p>
            </div>
            
            <h2>Avalia√ß√µes Recebidas</h2>
            <div id="user-ratings-history" class="history-container">
                <p class="loading-message">Carregando avalia√ß√µes...</p>
            </div>
        </div>
        
        <!-- Se√ß√£o de Perfil -->
        <div id="profile-section" class="content-section hidden">
            <h2>Seu Perfil</h2>
            <div class="profile-picture-container">
                <img id="profile-picture-preview" src="icons/default-profile.png" alt="Foto de perfil">
                <div class="profile-picture-upload">
                    <label for="profile-picture" class="secondary-button">Escolher Foto</label>
                    <input type="file" id="profile-picture" accept="image/*" hidden>
                </div>
            </div>
            <button id="save-profile-button" class="primary-button">Salvar Foto</button>
        </div>
        
        <!-- Se√ß√£o de Sugest√µes -->
        <div id="suggestions-section" class="content-section hidden">
            <h2>Enviar Sugest√£o ou Feedback</h2>
            <div class="form-group">
                <label for="suggestion-title">T√≠tulo</label>
                <input type="text" id="suggestion-title" placeholder="T√≠tulo da sua sugest√£o">
            </div>
            <div class="form-group">
                <label for="suggestion-text">Descri√ß√£o</label>
                <textarea id="suggestion-text" rows="4" placeholder="Descreva sua sugest√£o ou feedback"></textarea>
            </div>
            <div class="form-group">
                <label for="suggestion-type">Tipo</label>
                <select id="suggestion-type">
                    <option value="improvement">Melhoria</option>
                    <option value="bug">Problema</option>
                    <option value="feature">Nova Funcionalidade</option>
                    <option value="other">Outro</option>
                </select>
            </div>
            <button id="submit-suggestion-button" class="primary-button">Enviar Sugest√£o</button>
            
            <h2>Suas Sugest√µes</h2>
            <div id="suggestions-list" class="suggestions-list">
                <p class="loading-message">Carregando sugest√µes...</p>
            </div>
        </div>
        
        <!-- Se√ß√£o de Pre√ßos -->
        <div id="prices-section" class="content-section hidden">
            <h2>Tabela de Pre√ßos</h2>
            <div class="price-table-container">
                <img id="price-table-image" src="" alt="Tabela de pre√ßos n√£o dispon√≠vel">
            </div>
        </div>
    </section>

    <!-- Modal de Feedback de Cancelamento -->
    <div id="cancel-feedback-container" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal-feedback">&times;</span>
            <h2>Por que voc√™ est√° cancelando?</h2>
            <div class="cancel-reasons">
                <label class="radio-label">
                    <input type="radio" name="cancel-reason" value="driver_delay">
                    Demora do mototaxista
                </label>
                <label class="radio-label">
                    <input type="radio" name="cancel-reason" value="passenger_not_found">
                    Cliente n√£o est√° no local
                </label>
                <label class="radio-label">
                    <input type="radio" name="cancel-reason" value="driver_not_qualified">
                    Mototaxista n√£o parece apto
                </label>
                <label class="radio-label">
                    <input type="radio" name="cancel-reason" value="changed_mind">
                    Mudei de ideia
                </label>
                <label class="radio-label">
                    <input type="radio" name="cancel-reason" value="other">
                    Outro motivo
                </label>
                <textarea id="other-reason" class="hidden" placeholder="Descreva o motivo do cancelamento..."></textarea>
            </div>
            <button id="submit-cancel-feedback" class="primary-button">Confirmar Cancelamento</button>
        </div>
    </div>

    <!-- Se√ß√£o de Administra√ß√£o -->
    <section id="admin-section" class="admin-section hidden">
        <header>
            <div class="admin-header">
                <h1>Painel de Administra√ß√£o</h1>
                <button id="admin-logout-button" class="icon-button">üö™</button>
            </div>
        </header>
        
        <nav class="main-nav">
            <button id="admin-nav-dashboard" class="nav-button active">Dashboard</button>
            <button id="admin-nav-users" class="nav-button">Usu√°rios</button>
            <button id="admin-nav-rides" class="nav-button">Corridas</button>
            <button id="admin-nav-suggestions" class="nav-button">Sugest√µes</button>
            <button id="admin-nav-settings" class="nav-button">Configura√ß√µes</button>
        </nav>
        
        <!-- Dashboard Admin -->
        <div id="admin-dashboard" class="content-section">
            <h2>Dashboard</h2>
            <div class="stats-container">
                <div class="stat-card"><h3>Usu√°rios Totais</h3><p id="total-users">-</p></div>
                <div class="stat-card"><h3>Mototaxistas Ativos</h3><p id="active-drivers">-</p></div>
                <div class="stat-card"><h3>Corridas Hoje</h3><p id="rides-today">-</p></div>
                <div class="stat-card"><h3>Corridas Totais</h3><p id="total-rides">-</p></div>
            </div>
            <div id="charts-container">
                <div id="rides-chart" class="chart-container"></div>
                <div id="ratings-chart" class="chart-container"></div>
            </div>
            <h3>Atividades Recentes</h3>
            <div id="activity-list" class="activity-list-container"></div>
        </div>
        
        <!-- Usu√°rios Admin -->
        <div id="admin-users" class="content-section hidden">
            <h2>Gerenciar Usu√°rios</h2>
            <div class="admin-filters">
                <div class="search-container">
                    <input type="text" id="user-search" placeholder="Buscar usu√°rios...">
                </div>
                <div class="filter-container">
                    <select id="user-filter">
                        <option value="all">Todos</option>
                        <option value="user">Passageiros</option>
                        <option value="driver">Mototaxistas</option>
                        <option value="blocked">Bloqueados</option>
                    </select>
                </div>
            </div>
            <div id="users-list" class="users-list-container"></div>
        </div>
        
        <!-- Corridas Admin -->
        <div id="admin-rides" class="content-section hidden">
            <h2>Gerenciar Corridas</h2>
            <div class="admin-filters">
                <div class="search-container">
                    <input type="text" id="ride-search" placeholder="Buscar corridas...">
                </div>
                <div class="filter-container">
                    <select id="ride-filter">
                        <option value="all">Todas</option>
                        <option value="pending">Pendentes</option>
                        <option value="accepted">Aceitas</option>
                        <option value="completed">Conclu√≠das</option>
                        <option value="cancelled">Canceladas</option>
                    </select>
                </div>
            </div>
            <div id="admin-rides-list" class="admin-rides-list-container"></div>
        </div>
        
        <!-- Sugest√µes Admin -->
        <div id="admin-suggestions" class="content-section hidden">
            <h2>Gerenciar Sugest√µes</h2>
            <div class="admin-filters">
                <div class="search-container">
                    <input type="text" id="suggestion-search" placeholder="Buscar sugest√µes...">
                </div>
                <div class="filter-container">
                    <select id="suggestion-filter">
                        <option value="all">Todas</option>
                        <option value="pending">Pendentes</option>
                        <option value="approved">Aprovadas</option>
                        <option value="rejected">Rejeitadas</option>
                        <option value="implemented">Implementadas</option>
                    </select>
                </div>
            </div>
            <div id="admin-suggestions-list" class="admin-suggestions-list-container"></div>
        </div>
        
        <!-- Configura√ß√µes Admin -->
        <div id="admin-settings" class="content-section hidden">
            <h2>Configura√ß√µes do Sistema</h2>
            <div class="settings-container">
                <div class="form-group">
                    <label for="timeout-setting">Tempo limite para aceita√ß√£o de corridas (minutos)</label>
                    <input type="number" id="timeout-setting" min="1" max="60" value="5">
                </div>
                <button id="save-settings" class="primary-button">Salvar Configura√ß√µes</button>
            </div>
            
            <h2>Tabela de Pre√ßos</h2>
            <div class="form-group">
                <label for="price-table-upload">Fazer upload da tabela de pre√ßos (imagem)</label>
                <input type="file" id="price-table-upload" accept="image/*">
            </div>
            <button id="upload-price-table" class="primary-button">Salvar Tabela de Pre√ßos</button>
        </div>
    </section>

    <!-- Scripts -->
    <script src="geo-service.js"></script>
    <script src="rating-service.js"></script>
    <script src="admin-service.js"></script>
    <script src="script.js"></script>
    <script>
        // Registra o service worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registrado com sucesso:', registration);
                    })
                    .catch(error => {
                        console.log('Falha ao registrar Service Worker:', error);
                    });
            });
        }
        
        // Fun√ß√£o para fechar o modal de avalia√ß√£o (chamada pelo script.js)
        function closeRatingModal() {
            const modal = document.getElementById('rating-modal');
            if (modal) {
                modal.remove();
            }
        }
    </script>
</body>
</html>
